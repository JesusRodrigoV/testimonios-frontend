<header class="header">
  <div class="header-left">
    <img src="assets/images/logo-Sfondo.png" alt="Logo" class="logo" />
    <h1 class="app-title manuscript-text">
      <a routerLink="/" class="title-text">Legado de Bolivia</a>
    </h1>
  </div>

  <!-- Buscador Desktop -->
  <div class="search-field desktop-search">
    <div class="search-wrapper">
      <div class="search-border"></div>
      <div golden class="search-input-wrapper">
        <i class="bx bx-search search-icon"></i>
        <input
          type="text"
          class="input"
          placeholder="Buscar testimonios..."
          [(ngModel)]="searchQuery"
          (keyup.enter)="onSearch()"
        />
        <button
          mat-icon-button
          matTooltip="Filtros de búsqueda"
          [matMenuTriggerFor]="filterMenu"
          golden
        >
          <i class="bx bx-filter"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Buscador Mobile -->
  <div class="mobile-search-container">
    <button
      mat-icon-button
      class="mobile-search-toggle"
      (click)="toggleMobileSearch()"
      matTooltip="Buscar"
      golden
      *ngIf="!isMobileSearchActive"
    >
      <i class="bx bx-search"></i>
    </button>

    <div
      class="search-field mobile-search"
      [class.active]="isMobileSearchActive"
    >
      <div class="search-wrapper">
        <div class="search-border"></div>
        <div golden class="search-input-wrapper">
          <i class="bx bx-search search-icon"></i>
          <input
            type="text"
            class="input"
            placeholder="Buscar testimonios..."
            [(ngModel)]="searchQuery"
            (keyup.enter)="onSearch()"
          />
          <button
            mat-icon-button
            class="close-search"
            (click)="toggleMobileSearch()"
            matTooltip="Cerrar búsqueda"
            golden
          >
            <i class="bx bx-x"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="header-right">
    <button
      mat-flat-button
      class="create-post-btn"
      (click)="onCreatePost()"
      matTooltip="Crear nuevo testimonio"
      matTooltipPosition="below"
    >
      <i class="bx bx-plus"></i>
    </button>

    @if (!authStore.isAuthenticated()) {
      <button
        mat-button
        routerLink="/login"
        class="login-btn"
        matTooltip="Iniciar sesión en tu cuenta"
        matTooltipPosition="below"
        golden
      >
        Iniciar Sesión
      </button>
      <button
        mat-raised-button
        color="primary"
        routerLink="/register"
        matTooltip="Iniciar sesión en tu cuenta"
        matTooltipPosition="below"
      >
        Registrarse
      </button>
    } @else {
      <button
        mat-icon-button
        [matMenuTriggerFor]="notificationsMenu"
        [matBadge]="unreadNotifications"
        [matBadgeHidden]="unreadNotifications === 0"
        matBadgeColor="warn"
        class="notification-btn"
        matTooltip="Notificaciones"
        matTooltipPosition="below"
        golden
      >
        <i class="bx bx-bell"></i>
      </button>
      <button
        mat-icon-button
        [matMenuTriggerFor]="userMenu"
        class="avatar-button"
        matTooltip="Menú de usuario"
        matTooltipPosition="below"
        golden
      >
        <i class="bx bxs-user-circle" style="font-size: 24px"></i>
      </button>
    }
  </div>

  <mat-menu #notificationsMenu="matMenu">
    <div class="notifications-container">
      <h3>Notificaciones</h3>
    </div>
  </mat-menu>

  <!-- Menú de usuario -->
  <mat-menu #userMenu="matMenu">
    <button mat-menu-item routerLink="/profile" golden>
      <i class="bx bx-user"></i>
      Mi Perfil
    </button>
    <button mat-menu-item routerLink="/dashboard" golden *ngIf="isAdmin">
      <i class="bx bxs-dashboard"></i>
      Dashboard
    </button>
    <button mat-menu-item routerLink="/settings" golden>
      <i class="bx bx-cog"></i>
      Configuración
    </button>
    <mat-divider></mat-divider>
    <button mat-menu-item (click)="onLogout()" golden>
      <i class="bx bx-log-out"></i>
      Cerrar Sesión
    </button>
  </mat-menu>

  <mat-menu #filterMenu="matMenu" golden>
    <button mat-menu-item>
      <i class="bx bx-calendar"></i>
      Más recientes
    </button>
    <button mat-menu-item golden>
      <i class="bx bx-trending-up"></i>
      Más populares
    </button>
    <button mat-menu-item golden>
      <i class="bx bx-category"></i>
      Por categoría
    </button>
  </mat-menu>
</header>
