<h2 mat-dialog-title>Agregar a Colección</h2>
<mat-dialog-content>
  @if (loading()) {
    <div class="loading">
      <axl-spinner />
      <p>Cargando colecciones...</p>
    </div>
  } @else if (error()) {
    <div class="error">
      <mat-icon>error</mat-icon>
      <p>{{ error() }}</p>
    </div>
  } @else {
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Seleccionar Colección</mat-label>
      <mat-select [(ngModel)]="selectedCollectionId">
        <mat-option [value]="null">Crear nueva colección</mat-option>
        @for (collection of collections(); track collection.id_coleccion) {
          <mat-option [value]="collection.id_coleccion">{{ collection.titulo }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
    @if (selectedCollectionId === null) {
      <form [formGroup]="collectionForm">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Título</mat-label>
          <input matInput formControlName="titulo" required>
          <mat-error *ngIf="collectionForm.get('titulo')?.hasError('required')">Título es requerido</mat-error>
        </mat-form-field>
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Descripción</mat-label>
          <textarea matInput formControlName="descripcion" rows="4"></textarea>
        </mat-form-field>
      </form>
    }
  }
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button (click)="dialogRef.close()">Cancelar</button>
  <button mat-flat-button color="primary" (click)="addToCollection()" [disabled]="(selectedCollectionId === null && collectionForm.invalid) || loading()">
    Agregar
  </button>
</mat-dialog-actions>